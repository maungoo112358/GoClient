syntax = "proto3";

package gamepacket;
option go_package = "gosocket/gamepacket";

message GamePacket {
  uint32 Seq = 1;
  HandshakeRequest HandshakeRequest = 2;
  HandshakeResponse HandshakeResponse = 3;
  Heartbeat Heartbeat = 4;
  HeartbeatAck HeartbeatAck = 5;
  ClientPosition ClientPosition = 6;
  LobbyJoinBroadcast LobbyJoinBroadcast = 7;
  ClientLobbyPosition ClientLobbyPosition = 8;
  UsernamePrompt UsernamePrompt = 9;          
  UsernameSubmission UsernameSubmission = 10;  
  UsernameResponse UsernameResponse = 11;   
  ReconnectionRequest ReconnectionRequest = 12;
  ReconnectionResponse ReconnectionResponse = 13;
  Tile Tile = 14;
  TileSet TileSet = 15;
  ServerStatus ServerStatus = 99;
}

message HandshakeRequest {
  string clientName = 1;
}

message HandshakeResponse {
  string privateId = 1;
  string publicId = 2;
}

message UsernamePrompt {
  string message = 1; 
}

message UsernameSubmission {
  string username = 1;
}

message UsernameResponse {
  string username = 1;
  bool isAccepted = 2;
  string message = 3;
}

message ReconnectionRequest {
  string username = 1;
  string sessionToken = 2;
}

message ReconnectionResponse {
  bool isSuccessful = 1;
  string message = 2;
  string privateId = 3;
  string publicId = 4;
}

message LobbyJoinBroadcast {
  string publicId = 1;
  string colorhex = 2;
  ClientLobbyPosition position = 3;
  bool isLocalPlayer = 4;
}

message ClientPosition {
  string clientId = 1;
  float timestamp = 2;
  Vector_3 position = 3;
  Vector_3 velocity = 4;
}

message ClientLobbyPosition {
  Vector_3 position = 1;
}

message Heartbeat {
  string clientId = 1;
}

message HeartbeatAck {
  string clientId = 1;
}

message ServerStatus {
  string message = 1;
  string clientId = 2;
}

message TileSet {
  repeated Tile tiles = 2;
  int32 world_size = 3;
}

message Tile {
  string tileId = 1;
  Vector_3 position = 2;
  Vector_3 rotation = 3;
  Vector_3 scale = 4;
  TileType type = 5;
  bool isScalable = 6;
}

message Vector_3{
  float x = 1;
  float y = 2;
  float z = 3;
}

enum TileType {
  None = 0;
  ROAD_LANE = 1;
  CROSS_SECTION = 2;
  GRASS = 3;
}